{"version":3,"sources":["meteor://ðŸ’»app/packages/rocketchat:nrr/nrr.js"],"names":["Template","module","watch","require","v","Blaze","HTML","Spacebars","Tracker","toHTMLWithDataNonReactive","content","data","makeCursorReactive","obj","Meteor","Collection","Cursor","_depend","added","removed","changed","kw","Object","keys","hash","length","forEach","key","nonreactive","toHTMLWithData","registerHelper","_arguments","arguments","renderNonReactive","templateName","parentView","dataVar","get","view","View","Raw","onViewReady","call","_onViewRendered","onViewRendered"],"mappings":"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","file":"/packages/rocketchat_nrr.js","sourcesContent":["/* eslint new-cap:0 */\n\nimport { Template } from 'meteor/templating';\nimport { Blaze } from 'meteor/blaze';\nimport { HTML } from 'meteor/htmljs';\nimport { Spacebars } from 'meteor/spacebars';\nimport { Tracker } from 'meteor/tracker';\n\nBlaze.toHTMLWithDataNonReactive = function(content, data) {\n\tconst makeCursorReactive = function(obj) {\n\t\tif (obj instanceof Meteor.Collection.Cursor) {\n\t\t\treturn obj._depend({\n\t\t\t\tadded: true,\n\t\t\t\tremoved: true,\n\t\t\t\tchanged: true\n\t\t\t});\n\t\t}\n\t};\n\n\tmakeCursorReactive(data);\n\n\tif (data instanceof Spacebars.kw && Object.keys(data.hash).length > 0) {\n\t\tObject.keys(data.hash).forEach(key => {\n\t\t\tmakeCursorReactive(data.hash[key]);\n\t\t});\n\n\t\tdata = data.hash;\n\t}\n\n\treturn Tracker.nonreactive(() => Blaze.toHTMLWithData(content, data));\n};\n\nBlaze.registerHelper('nrrargs', function() {\n\treturn {\n\t\t_arguments: arguments\n\t};\n});\n\nBlaze.renderNonReactive = function(templateName, data) {\n\tconst { _arguments } = this.parentView.dataVar.get();\n\n\t[templateName, data] = _arguments;\n\n\treturn Tracker.nonreactive(() => {\n\t\tconst view = new Blaze.View('nrr', () => {\n\t\t\treturn HTML.Raw(Blaze.toHTMLWithDataNonReactive(Template[templateName], data));\n\t\t});\n\n\t\tview.onViewReady(() => {\n\t\t\tconst { onViewReady } = Template[templateName];\n\t\t\treturn onViewReady && onViewReady.call(view, data);\n\t\t});\n\n\t\tview._onViewRendered(() => {\n\t\t\tconst { onViewRendered } = Template[templateName];\n\t\t\treturn onViewRendered && onViewRendered.call(view, data);\n\t\t});\n\n\t\treturn view;\n\t});\n};\n\nBlaze.registerHelper('nrr', Blaze.Template('nrr', Blaze.renderNonReactive));\n"]}