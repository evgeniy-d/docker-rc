{"version":3,"sources":["meteor://ðŸ’»app/packages/rocketchat:tutum/startup.js"],"names":["process","env","DOCKERCLOUD_REDIS_HOST","redis","require","client","createClient","on","err","console","log","del","DOCKERCLOUD_CLIENT_HOST","rpush","DOCKERCLOUD_CLIENT_NAME","port","PORT","DOCKERCLOUD_IP_ADDRESS","split","expire"],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAAA;;;;;;AAOA,IAAIA,QAAQC,GAAR,CAAYC,sBAAZ,IAAsC,IAA1C,EAAgD;AAC/C,QAAMC,QAAQC,QAAQ,OAAR,CAAd;;AAEA,QAAMC,SAASF,MAAMG,YAAN,CAAmBN,QAAQC,GAAR,CAAYC,sBAA/B,CAAf;AAEAG,SAAOE,EAAP,CAAU,OAAV,EAAmBC,OAAOC,QAAQC,GAAR,CAAY,gBAAZ,EAA8BF,GAA9B,CAA1B;AAEAH,SAAOM,GAAP,CAAY,YAAYX,QAAQC,GAAR,CAAYW,uBAAyB,EAA7D;AACAP,SAAOQ,KAAP,CAAc,YAAYb,QAAQC,GAAR,CAAYW,uBAAyB,EAA/D,EAAkEZ,QAAQC,GAAR,CAAYa,uBAA9E;AAEA,QAAMC,OAAOf,QAAQC,GAAR,CAAYe,IAAZ,IAAoB,IAAjC;AACAX,SAAOQ,KAAP,CAAc,YAAYb,QAAQC,GAAR,CAAYW,uBAAyB,EAA/D,EAAmE,UAAUZ,QAAQC,GAAR,CAAYgB,sBAAZ,CAAmCC,KAAnC,CAAyC,GAAzC,EAA8C,CAA9C,CAAkD,IAAIH,IAAM,EAAzI,EAX+C,CAa/C;;AACAf,UAAQO,EAAR,CAAW,SAAX,EAAsB,MAAMF,OAAOc,MAAP,CAAe,YAAYnB,QAAQC,GAAR,CAAYW,uBAAyB,EAAhE,EAAmE,EAAnE,CAA5B;AAEAZ,UAAQO,EAAR,CAAW,QAAX,EAAqB,MAAMF,OAAOc,MAAP,CAAe,YAAYnB,QAAQC,GAAR,CAAYW,uBAAyB,EAAhE,EAAmE,EAAnE,CAA3B;AACA,C","file":"/packages/rocketchat_tutum.js","sourcesContent":["/* Examples\n\nDOCKERCLOUD_REDIS_HOST=redis://:password@host:6379\nDOCKERCLOUD_CLIENT_NAME=mywebsite\nDOCKERCLOUD_CLIENT_HOST=mywebsite.dotcloud.com\n*/\n\nif (process.env.DOCKERCLOUD_REDIS_HOST != null) {\n\tconst redis = require('redis');\n\n\tconst client = redis.createClient(process.env.DOCKERCLOUD_REDIS_HOST);\n\n\tclient.on('error', err => console.log('Redis error ->', err));\n\n\tclient.del(`frontend:${ process.env.DOCKERCLOUD_CLIENT_HOST }`);\n\tclient.rpush(`frontend:${ process.env.DOCKERCLOUD_CLIENT_HOST }`, process.env.DOCKERCLOUD_CLIENT_NAME);\n\n\tconst port = process.env.PORT || 3000;\n\tclient.rpush(`frontend:${ process.env.DOCKERCLOUD_CLIENT_HOST }`, `http://${ process.env.DOCKERCLOUD_IP_ADDRESS.split('/')[0] }:${ port }`);\n\n\t// removes the redis entry in 90 seconds on a SIGTERM\n\tprocess.on('SIGTERM', () => client.expire(`frontend:${ process.env.DOCKERCLOUD_CLIENT_HOST }`, 90));\n\n\tprocess.on('SIGINT', () => client.expire(`frontend:${ process.env.DOCKERCLOUD_CLIENT_HOST }`, 90));\n}\n"]}